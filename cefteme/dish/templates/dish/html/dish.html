{% extends 'dish/html/base.html' %}
{% load static %}

{% block css %}
    <link href="{% static 'vendor/css/products.css' %}" rel="stylesheet">
    <link href="{% static 'vendor/css/dish.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}

    <style>
    .product-container {
      display: flex;
      flex-wrap: wrap;
    }

    .img-dish{
        max-width: 100%;
        max-height: 100%;
    }

    .product-image {
      width: 50%;
      margin-right: 20px;
    }

    .product-details {
      width: 50%;
    }

    .comments {
      width: 100%;
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }

    .comment {
      margin-bottom: 10px;
      border: 1px solid #ccc;
      padding: 10px;
      width: 100%;
    }

    .comment .author {
      font-weight: bold;
    }

    .comment .date {
      font-style: italic;
      font-size: 12px;
      color: #888;
    }

    .comment .bal-5 {
      font-size: 14px;
        font-weight: bold;
      color: #006400;
    }

    .comment .bal-4 {
      font-size: 14px;
        font-weight: bold;
      color: #556B2F;
    }

    .comment .bal-3 {
      font-size: 14px;
      font-weight: bold;
      color: #8B8B00;
    }

    .comment .bal-2 {
      font-size: 14px;
        font-weight: bold;
      color: #FF8C00;
    }

    .comment .bal-1 {
      font-size: 14px;
        font-weight: bold;
      color: #8B0000;
    }

    .comment .message {
      margin-top: 5px;
    }

    .comment-form {
      margin-top: 20px;
      width: 100%;
    }

    .comment-form textarea {
      width: 100%;
      height: 80px;
      resize: vertical;
    }

    .comment-form button {
      margin-top: 10px;
    }
  </style>

    <div class="container">
        <div class="row">
            <div class="col-lg-9">
                <div class="product-container">
                    <div class="product-image">
                        <img class="img-dish" src="{{  dish.image.url }}" alt="Изображение товара">
                    </div>
                    <div class="product-details">
                        <h2 class="dish-title">{{ dish.name }}</h2>
                        <p>
                            Состав: {% for get_ingredient in dish.get_ingredients %}
                                        {{ get_ingredient.name }}{% if not loop.last %},{% endif %}
                                    {% endfor %}
                        </p>
                        <p>Цена: {{ dish.price }}p.</p>
                    </div>
                </div>


                <div class="comment-form">
                    <h4>Оставьте свой отзыв</h4>
                    <form action="{% url 'dish:dish' dish.slug %}" method="post">
                        {% csrf_token %}

                        <div>{{ form.non_field_errors }}</div>

                        {% for f in form %}
                            <p><label for="{{ f.id_for_label }}">{{ f.label }}: </label>{{ f }}</p>
                            <div class="error-decor">{{ f.errors }}</div>
                        {% endfor %}

                        <button type="submit">Отправить</button>
                    </form>
                </div>
            </div>

            <div class="col-lg-3">

                <div class="comments">
                    <h3>Отзывы:</h3>
                    {% for rev in review %}
                        {% if rev.id_dish.pk == dish.pk %}
                        <div class="comment">
                            <div class="author">{{ rev.id_user.username }}</div>
                            <div class="date">{{  rev.date_create }}</div>
                            <div {% if rev.estimation == 5 %}
                                    class="bal-5"
                                {% elif rev.estimation == 4 %}
                                    class="bal-4"
                                {% elif rev.estimation == 3%}
                                    class="bal-3"
                                {% elif rev.estimation == 2 %}
                                    class="bal-2"
                                {% elif rev.estimation == 1 %}
                                    class="bal-1"
                                {% endif %}>
                                <img src="/static/vendor/img/review/starF.png" height="12" width="12"> 5/{{  rev.estimation }}
                            </div>
                            <div class="message">{{ rev.description }}</div>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

{% endblock %}